
> ricopoc@0.0.1 test /Volumes/Dev/RICO/poc
> scripts/run_tests.sh all

Starting new ganache-cli instance at port 8545
exchange neither monster ethics bless cancel ghost excite business record warfare invite

--------------------------------------------------------------------
 Running all tests in "test" folder:
--------------------------------------------------------------------

Compiling your contracts...
===========================
> Everything is up to date, there is nothing to compile.

[1;37m  ----------------------------------------------------------------
  Step 1 - Setting up helpers and globals 
  ---------------------------------------------------------------- [0m
[1;37m  ----------------------------------------------------------------
  Step 2 - Run tests 
  ---------------------------------------------------------------- [0m

[0m[0m
[0m  SafeMath[0m
[0m    add[0m
    [32m  âœ“[0m[90m adds correctly[0m[31m (31ms)[0m
    [32m  âœ“[0m[90m reverts on addition overflow[0m[31m (37ms)[0m
[0m    sub[0m
    [32m  âœ“[0m[90m subtracts correctly[0m[33m (13ms)[0m
    [32m  âœ“[0m[90m reverts if subtraction result would be negative[0m[31m (17ms)[0m
[0m    mul[0m
    [32m  âœ“[0m[90m multiplies correctly[0m[31m (25ms)[0m
    [32m  âœ“[0m[90m multiplies by zero correctly[0m[31m (24ms)[0m
    [32m  âœ“[0m[90m reverts on multiplication overflow[0m[33m (15ms)[0m
[0m    div[0m
    [32m  âœ“[0m[90m divides correctly[0m[33m (11ms)[0m
    [32m  âœ“[0m[90m divides zero correctly[0m[33m (11ms)[0m
    [32m  âœ“[0m[90m returns complete number result on non-even division[0m[31m (16ms)[0m
    [32m  âœ“[0m[90m reverts on division by zero[0m[33m (13ms)[0m
[0m    mod[0m
    [32m  âœ“[0m[90m reverts with a 0 divisor[0m[31m (17ms)[0m
[0m      modulos correctly[0m
      [32m  âœ“[0m[90m when the dividend is smaller than the divisor[0m[33m (11ms)[0m
      [32m  âœ“[0m[90m when the dividend is equal to the divisor[0m[33m (14ms)[0m
      [32m  âœ“[0m[90m when the dividend is larger than the divisor[0m[33m (11ms)[0m
      [32m  âœ“[0m[90m when the dividend is a multiple of the divisor[0m[33m (10ms)[0m

[0m  ERC1820 - Token Registry[0m
[0m    Step 1 - Before deployment state[0m
    [32m  âœ“[0m[90m Contract Code at address: 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24 should be 0x[0m
    [32m  âœ“[0m[90m Deployer address: 0xa990077c3205cbDf861e17Fa532eeB069cE9fF96 balance should be 0 eth[0m
    [32m  âœ“[0m[90m Funds Supplier address: 0xFE6B56FdCF920382Af1493828E79C017EE090F2a balance should be at least 0.08 eth[0m
[0m    Step 2 - Deployment preparation[0m
[0m      New Account balances after Supplier sends value to SenderAddress[0m
      [32m  âœ“[0m[90m FundsSupplier balance has deploymentCost + tx fee substracted[0m
      [32m  âœ“[0m[90m SenderAddress balance is equal to deploymentCost[0m
[0m    Step 3 - ERC1820 Deployment[0m
      Gas used for deployment: 711453
      Contract Address: 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24

[0m      Validation after ERC1820 Registry contract deployment[0m
[0m        Transaction[0m
        [32m  âœ“[0m[90m status is true[0m
        [32m  âœ“[0m[90m signature is valid[0m
        [32m  âœ“[0m[90m from address is correct[0m
        [32m  âœ“[0m[90m Contract address is 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24[0m
[0m        Contract[0m
        [32m  âœ“[0m[90m code at address exists[0m
        [32m  âœ“[0m[90m contract has the getManager method which can be called[0m[33m (13ms)[0m

[0m  ERC777 - RICO Token[0m
[0m    Deployment[0m
      Gas used for deployment: 3369731
      Contract Address: 0x88eC20080706B787C7BF684880f3d1899433f760

    [32m  âœ“[0m[90m Gas usage should be lower than 3.5m.[0m
[0m      basic information[0m
      [32m  âœ“[0m[90m returns the name[0m[33m (15ms)[0m
      [32m  âœ“[0m[90m returns the symbol[0m[33m (13ms)[0m
      [32m  âœ“[0m[90m returns a granularity of 1[0m[33m (11ms)[0m
      [32m  âœ“[0m[90m returns the default operators[0m[33m (13ms)[0m
      [32m  âœ“[0m[90m default operators are operators for all accounts[0m
      [32m  âœ“[0m[90m returns the total supply[0m[33m (11ms)[0m
      [32m  âœ“[0m[90m returns 18 when decimals is called[0m[33m (10ms)[0m
      [32m  âœ“[0m[90m the ERC777Token interface is registered in the registry[0m[33m (13ms)[0m
      [32m  âœ“[0m[90m the ERC20Token interface is registered in the registry[0m[33m (13ms)[0m
[0m      balanceOf[0m
[0m        for an account with no tokens[0m
        [32m  âœ“[0m[90m returns zero[0m[33m (12ms)[0m
[0m        for an account with tokens[0m
        [32m  âœ“[0m[90m returns their balance[0m[33m (13ms)[0m

[0m  ERC777 - ERC20 Token compatibility[0m
  [32m  âœ“[0m[90m creation: in contract settings should match settings[0m[31m (48ms)[0m
  [32m  âœ“[0m[90m creation: should create a correct initial balance for the creator[0m[33m (10ms)[0m
  [32m  âœ“[0m[90m transfers: ether transfer should be reversed.[0m[31m (53ms)[0m
  [32m  âœ“[0m[90m transfers: should transfer 10000 to accounts[1] with creator having at least 10000[0m[31m (76ms)[0m
  [32m  âœ“[0m[90m transfers: should fail when trying to transfer total amount + 1 to accounts[1] with creator having total amount[0m[31m (53ms)[0m
  [32m  âœ“[0m[90m transfers: should handle zero-transfers normally[0m[31m (58ms)[0m
  [32m  âœ“[0m[90m transfers: should throw if receiver address is 0x0[0m[31m (40ms)[0m
  [32m  âœ“[0m[90m approvals: msg.sender should approve 100 to accounts[1][0m[31m (58ms)[0m
  [32m  âœ“[0m[90m approvals: msg.sender approves accounts[1] of 100 & withdraws 20 once.[0m[31m (191ms)[0m
  [32m  âœ“[0m[90m approvals: msg.sender approves accounts[1] of 100 & withdraws 20 twice.[0m[31m (258ms)[0m
  [32m  âœ“[0m[90m approvals: msg.sender approves accounts[1] of 100 & withdraws 50 & 60 (2nd tx should fail)[0m[31m (149ms)[0m
  [32m  âœ“[0m[90m approvals: attempt withdrawal from account with no allowance (should fail)[0m[31m (64ms)[0m
  [32m  âœ“[0m[90m approvals: allow accounts[1] 100 to withdraw from creator. Withdraw 60 and then approve 0 & attempt transfer.[0m[31m (200ms)[0m
  [32m  âœ“[0m[90m approvals: approve max (2^256 - 1)[0m[31m (59ms)[0m
  [32m  âœ“[0m[90m allowance: should start with zero[0m[33m (9ms)[0m
  [32m  âœ“[0m[90m approvals: approve max (2^256 - 1)[0m[31m (51ms)[0m
  [32m  âœ“[0m[90m events: should fire Transfer event properly[0m[31m (62ms)[0m
  [32m  âœ“[0m[90m events: should fire Transfer event normally on a zero transfer[0m[31m (56ms)[0m
  [32m  âœ“[0m[90m events: should fire Approval event properly[0m[31m (42ms)[0m

[0m  ReversableICO[0m
      Gas used for deployment: 2441705
      Contract Address: 0x35C310d59E2b7f1F96A5e133Efb20538266e4053

[0m    Stage 1 - Deployment[0m
    [32m  âœ“[0m[90m Gas usage should be lower than 6.7m.[0m
    [32m  âœ“[0m[90m Property deployerAddress should be 0x9d9216e0a29468bE1eCaCc351ce3887be8a26222[0m[33m (10ms)[0m
    [32m  âœ“[0m[90m Property initialized should be false[0m[33m (10ms)[0m
    [32m  âœ“[0m[90m Property running should be false[0m[33m (9ms)[0m
    [32m  âœ“[0m[90m Property frozen should be false[0m[33m (11ms)[0m
    [32m  âœ“[0m[90m Property ended should be false[0m[33m (13ms)[0m
    [32m  âœ“[0m[90m Property TokenTrackerAddress should be address(0)[0m[33m (10ms)[0m
    [32m  âœ“[0m[90m Property whitelistControllerAddress should be address(0)[0m[33m (10ms)[0m
[0m    Stage 2 - Transfer tokens to RICO contract address[0m
    [32m  âœ“[0m[90m RICO Contract should have the correct token balance (15000000000000000000000000)[0m[33m (12ms)[0m
[0m    Stage 3 - Initialisation - addSettings()[0m
[0m      Contract settings[0m
      [32m  âœ“[0m[90m Property initialized should be true[0m[33m (9ms)[0m
      [32m  âœ“[0m[90m Property running should be false[0m[33m (10ms)[0m
      [32m  âœ“[0m[90m Property frozen should be false[0m[31m (73ms)[0m
      [32m  âœ“[0m[90m Property ended should be false[0m[33m (12ms)[0m
      [32m  âœ“[0m[90m Property TokenTrackerAddress should be deployed ERC777 Token Contract address[0m[31m (16ms)[0m
      [32m  âœ“[0m[90m Property whitelistControllerAddress should be 0x42D0290527b2F2334c2E30C10562C1731DBA9dFE[0m[33m (9ms)[0m
      [32m  âœ“[0m[90m EndBlock matches settings[0m[33m (8ms)[0m
[0m      Contract Stages[0m
      [32m  âœ“[0m[90m Stage Count is correct[0m[33m (15ms)[0m
      [32m  âœ“[0m[90m Allocation StartBlock matches settings[0m
      [32m  âœ“[0m[90m Allocation duration is AllocationBlockCount[0m
      [32m  âœ“[0m[90m Allocation EndBlock matches settings[0m
      [32m  âœ“[0m[90m AllocationPrice matches settings[0m
      [32m  âœ“[0m[90m First Distribution Stage settings are correct[0m[33m (10ms)[0m
      [32m  âœ“[0m[90m Last Distribution Stage settings are correct[0m[33m (10ms)[0m
      [32m  âœ“[0m[90m Last Distribution Stage end_block matches contract EndBlock[0m[33m (13ms)[0m
[0m      Contract Assets[0m
      [32m  âœ“[0m[90m RICO Contract should have 0 eth[0m
      [32m  âœ“[0m[90m RICO Contract should have the correct token balance (15000000000000000000000000)[0m[31m (19ms)[0m
      [32m  âœ“[0m[90m InitialTokenSupply property should match Contract token balance (15000000000000000000000000)[0m[31m (22ms)[0m
[0m    Contract Methods[0m
[0m      getCurrentStage()[0m
      [32m  âœ“[0m[90m Returns stage 0 if at Allocation start_block[0m[31m (57ms)[0m
      [32m  âœ“[0m[90m Returns stage 0 if at Allocation end_block[0m[31m (55ms)[0m
      [32m  âœ“[0m[90m Returns stage 1 if at stage 1 start_block[0m[31m (60ms)[0m
      [32m  âœ“[0m[90m Returns stage 1 if at stage 1 end_block[0m[31m (64ms)[0m
      [32m  âœ“[0m[90m Returns stage 5 if at stage 5 start_block[0m[31m (60ms)[0m
      [32m  âœ“[0m[90m Returns stage 5 if at stage 5 end_block[0m[31m (56ms)[0m
      [32m  âœ“[0m[90m Returns last stage if at last stage start_block[0m[31m (58ms)[0m
      [32m  âœ“[0m[90m Returns last stage if at last stage end_block[0m[31m (62ms)[0m
      [32m  âœ“[0m[90m Returns 255 after last stage end_block[0m[31m (50ms)[0m
[0m      getStageAtBlock(uint256)[0m
      [32m  âœ“[0m[90m Returns stage 0 if getStageAtBlock( Allocation.start_block )[0m[31m (26ms)[0m
      [32m  âœ“[0m[90m Returns stage 0 if getStageAtBlock( Allocation.end_block )[0m[31m (19ms)[0m
      [32m  âœ“[0m[90m Returns stage 1 if getStageAtBlock( stage_1.start_block )[0m[31m (20ms)[0m
      [32m  âœ“[0m[90m Returns stage 1 if getStageAtBlock( stage_1.end_block )[0m[31m (29ms)[0m
      [32m  âœ“[0m[90m Returns stage 5 if getStageAtBlock( stage_5.start_block )[0m[31m (19ms)[0m
      [32m  âœ“[0m[90m Returns stage 5 if getStageAtBlock( stage_5.end_block )[0m[31m (19ms)[0m
      [32m  âœ“[0m[90m Returns stage last stage if getStageAtBlock( last_stage.start_block )[0m[31m (24ms)[0m
      [32m  âœ“[0m[90m Returns stage last stage if getStageAtBlock( last_stage.end_block )[0m[31m (19ms)[0m
      [32m  âœ“[0m[90m Returns 255 if getStageAtBlock( last_stage.end_block + 1 )[0m[31m (19ms)[0m
[0m      getCurrentPrice()[0m
      [32m  âœ“[0m[90m Returns correct value for Allocation phase[0m[31m (56ms)[0m
      [32m  âœ“[0m[90m Returns correct value for stage 1[0m[31m (62ms)[0m
      [32m  âœ“[0m[90m Returns correct value for stage 5[0m[31m (54ms)[0m
      [32m  âœ“[0m[90m Returns correct value for last stage[0m[31m (47ms)[0m
      [32m  âœ“[0m[90m Returns 0 after last stage ended[0m[31m (58ms)[0m
[0m      getPriceAtBlock(uint256)[0m
      [32m  âœ“[0m[90m Returns correct value for Allocation phase[0m[31m (22ms)[0m
      [32m  âœ“[0m[90m Returns correct value for stage 1[0m[31m (31ms)[0m
      [32m  âœ“[0m[90m Returns correct value for stage 5[0m[31m (23ms)[0m
      [32m  âœ“[0m[90m Returns correct value for last stage[0m[31m (23ms)[0m
      [32m  âœ“[0m[90m Returns 0 after last stage ended[0m[31m (29ms)[0m
[0m      getTokenAmountForEthAtStage(uint256, uint8)[0m
      [32m  âœ“[0m[90m Returns correct value for 1 eth & Allocation stage[0m[31m (21ms)[0m
      [32m  âœ“[0m[90m Returns correct value for 1 eth & stage 1[0m[31m (20ms)[0m
      [32m  âœ“[0m[90m Returns correct value for 0.002 eth & Allocation stage ( results in 1 full token )[0m[31m (26ms)[0m
      [32m  âœ“[0m[90m Returns correct value for 1 wei & Allocation stage ( results in 500 token grains )[0m[31m (22ms)[0m
[0m    Stage 4 - Funding Start[0m
participant 0x9d9216e0a29468bE1eCaCc351ce3887be8a26222
funds 50000 eth
receivedEth 30000 eth
max_accepted_funds 30000 eth
ParticipantCount 1
ParticipantByAddress Result {
  '0': false,
  '1': '1',
  whitelisted: false,
  contributionsCount: '1' }
ParticipantContributionDetails Result {
  '0': '30000000000000000000000',
  '1': '148351',
  '2': '1',
  '3': '1',
  '4': '14285714285714285714285714' }
contractTokenBalance 15000000000000000000000000
whitelistOrReject gas: 118144
ParticipantByAddress Result {
  '0': true,
  '1': '1',
  whitelisted: true,
  contributionsCount: '1' }
ParticipantContributionDetails Result {
  '0': '30000000000000000000000',
  '1': '148351',
  '2': '1',
  '3': '2',
  '4': '14285714285714285714285714' }
contractTokenBalance 714285714285714285714286
ParticipantTokenBalance 14285714285714285714285714
    [32m  âœ“[0m[90m account[0] can commit funds ( 30.000 eth )[0m[31m (302ms)[0m


[92m [0m[32m 118 passing[0m[90m (6s)[0m

Done
--------------------------------------------------------------------

Killing existing ganache-cli instance at pid 70014.

